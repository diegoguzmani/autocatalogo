{% extends 'inventario/base.html' %}
{% load estilos_extras %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
        
        <h4 class="fw-bold text-center mb-4">Calculadora Rápida</h4>
        
        <div class="card shadow-sm border-0 rounded-4 bg-white p-2">
            <div class="card-body">
                
                <!-- DÓLAR -->
                <div class="mb-4">
                    <label class="price-label text-success mb-1">MONTO EN DÓLARES ($)</label>
                    <div class="input-group input-group-lg">
                        <span class="input-group-text bg-success bg-opacity-10 text-success border-0 rounded-start-4 fw-bold">$</span>
                        <input type="number" id="calc-usd" class="form-control bg-light border-0 fw-bold text-success fs-2" placeholder="0">
                    </div>
                </div>

                <!-- EURO -->
                <div class="mb-4">
                    <label class="price-label text-primary mb-1">MONTO EN EUROS (€)</label>
                    <div class="input-group input-group-lg">
                        <span class="input-group-text bg-primary bg-opacity-10 text-primary border-0 rounded-start-4 fw-bold">€</span>
                        <input type="number" id="calc-eur" class="form-control bg-light border-0 fw-bold text-primary fs-2" placeholder="0">
                    </div>
                </div>

                <!-- BOLÍVARES -->
                <div class="mb-4">
                    <label class="price-label text-dark mb-1">MONTO EN BOLÍVARES (Bs)</label>
                    <div class="input-group input-group-lg">
                        <span class="input-group-text bg-dark bg-opacity-10 text-dark border-0 rounded-start-4 fw-bold">Bs</span>
                        <input type="number" id="calc-bs" class="form-control bg-light border-0 fw-bold text-dark fs-2" placeholder="0">
                    </div>
                </div>

                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-light rounded-pill py-2 text-muted" onclick="limpiarCampos()">
                        Borrar Todo
                    </button>
                </div>

            </div>
            <div class="card-footer bg-white border-0 text-center pb-3">
                 <small class="text-muted">
                    Tasas: $ {{ config.tasa_dolar|formato_ve }} | € {{ config.tasa_euro|formato_ve }}
                 </small>
            </div>
        </div>

    </div>
</div>

<script>
    // (Mismo script de JavaScript que ya tenías, funciona igual)
    document.addEventListener('DOMContentLoaded', function() {
        const tasaUSD = parseFloat("{{ config.tasa_dolar }}".replace(',', '.'));
        const tasaEUR = parseFloat("{{ config.tasa_euro }}".replace(',', '.'));
        
        const iUSD = document.getElementById('calc-usd');
        const iEUR = document.getElementById('calc-eur');
        const iBS = document.getElementById('calc-bs');

        function calc(tipo) {
            let val = parseFloat(tipo === 'usd' ? iUSD.value : (tipo === 'eur' ? iEUR.value : iBS.value));
            if(isNaN(val)) { 
                if(tipo !== 'usd') iUSD.value = ''; 
                if(tipo !== 'eur') iEUR.value = ''; 
                if(tipo !== 'bs') iBS.value = ''; 
                return;
            }

            let bs = 0;
            if (tipo === 'usd') bs = val * tasaUSD;
            if (tipo === 'eur') bs = val * tasaEUR;
            if (tipo === 'bs') bs = val;

            if (tipo !== 'bs') iBS.value = bs.toFixed(2);
            if (tipo !== 'usd' && tasaUSD > 0) iUSD.value = (bs / tasaUSD).toFixed(2);
            if (tipo !== 'eur' && tasaEUR > 0) iEUR.value = (bs / tasaEUR).toFixed(2);
        }

        iUSD.addEventListener('input', () => calc('usd'));
        iEUR.addEventListener('input', () => calc('eur'));
        iBS.addEventListener('input', () => calc('bs'));
        window.limpiarCampos = () => { iUSD.value = ''; iEUR.value = ''; iBS.value = ''; }
    });
</script>
{% endblock %}